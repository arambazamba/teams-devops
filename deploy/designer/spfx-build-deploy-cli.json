{
    "source": 2,
    "revision": 9,
    "description": null,
    "createdBy": {
        "displayName": "Alexander Pajer",
        "url": "https://spsprodweu3.vssps.visualstudio.com/A6aa91e30-0fdc-4040-a4af-1d637da19519/_apis/Identities/459f3623-3d4d-6221-8365-dea680982fc6",
        "_links": {
            "avatar": {
                "href": "https://dev.azure.com/integrationstraining/_apis/GraphProfile/MemberAvatars/aad.NDU5ZjM2MjMtM2Q0ZC03MjIxLTgzNjUtZGVhNjgwOTgyZmM2"
            }
        },
        "id": "459f3623-3d4d-6221-8365-dea680982fc6",
        "uniqueName": "alexander.pajer@integrations.at",
        "imageUrl": "https://dev.azure.com/integrationstraining/_apis/GraphProfile/MemberAvatars/aad.NDU5ZjM2MjMtM2Q0ZC03MjIxLTgzNjUtZGVhNjgwOTgyZmM2",
        "descriptor": "aad.NDU5ZjM2MjMtM2Q0ZC03MjIxLTgzNjUtZGVhNjgwOTgyZmM2"
    },
    "createdOn": "2021-03-18T09:25:01.980Z",
    "modifiedBy": {
        "displayName": "Alexander Pajer",
        "url": "https://spsprodweu3.vssps.visualstudio.com/A6aa91e30-0fdc-4040-a4af-1d637da19519/_apis/Identities/459f3623-3d4d-6221-8365-dea680982fc6",
        "_links": {
            "avatar": {
                "href": "https://dev.azure.com/integrationstraining/_apis/GraphProfile/MemberAvatars/aad.NDU5ZjM2MjMtM2Q0ZC03MjIxLTgzNjUtZGVhNjgwOTgyZmM2"
            }
        },
        "id": "459f3623-3d4d-6221-8365-dea680982fc6",
        "uniqueName": "alexander.pajer@integrations.at",
        "imageUrl": "https://dev.azure.com/integrationstraining/_apis/GraphProfile/MemberAvatars/aad.NDU5ZjM2MjMtM2Q0ZC03MjIxLTgzNjUtZGVhNjgwOTgyZmM2",
        "descriptor": "aad.NDU5ZjM2MjMtM2Q0ZC03MjIxLTgzNjUtZGVhNjgwOTgyZmM2"
    },
    "modifiedOn": "2021-07-11T12:38:42.533Z",
    "isDeleted": false,
    "lastRelease": {
        "id": 6,
        "name": "Release-6",
        "artifacts": [],
        "_links": {},
        "description": "",
        "releaseDefinition": { "id": 2, "projectReference": null, "_links": {} },
        "createdOn": "2021-07-11T12:38:44.980Z",
        "createdBy": {
            "displayName": "Alexander Pajer",
            "url": "https://spsprodweu3.vssps.visualstudio.com/A6aa91e30-0fdc-4040-a4af-1d637da19519/_apis/Identities/459f3623-3d4d-6221-8365-dea680982fc6",
            "_links": {
                "avatar": {
                    "href": "https://dev.azure.com/integrationstraining/_apis/GraphProfile/MemberAvatars/aad.NDU5ZjM2MjMtM2Q0ZC03MjIxLTgzNjUtZGVhNjgwOTgyZmM2"
                }
            },
            "id": "459f3623-3d4d-6221-8365-dea680982fc6",
            "uniqueName": "alexander.pajer@integrations.at",
            "imageUrl": "https://dev.azure.com/integrationstraining/_apis/GraphProfile/MemberAvatars/aad.NDU5ZjM2MjMtM2Q0ZC03MjIxLTgzNjUtZGVhNjgwOTgyZmM2",
            "descriptor": "aad.NDU5ZjM2MjMtM2Q0ZC03MjIxLTgzNjUtZGVhNjgwOTgyZmM2"
        }
    },
    "variables": {
        "catalogsite": { "value": "site/apps" },
        "password": { "value": null, "isSecret": true },
        "pkgname": { "value": "devops-wp.sppkg" },
        "tenant": { "value": "integrationsonline" },
        "username": { "value": "alexander.pajer@integrations.at" }
    },
    "variableGroups": [],
    "environments": [
        {
            "id": 2,
            "name": "Deploy",
            "rank": 1,
            "owner": {
                "displayName": "Alexander Pajer",
                "url": "https://spsprodweu3.vssps.visualstudio.com/A6aa91e30-0fdc-4040-a4af-1d637da19519/_apis/Identities/459f3623-3d4d-6221-8365-dea680982fc6",
                "_links": {
                    "avatar": {
                        "href": "https://dev.azure.com/integrationstraining/_apis/GraphProfile/MemberAvatars/aad.NDU5ZjM2MjMtM2Q0ZC03MjIxLTgzNjUtZGVhNjgwOTgyZmM2"
                    }
                },
                "id": "459f3623-3d4d-6221-8365-dea680982fc6",
                "uniqueName": "alexander.pajer@integrations.at",
                "imageUrl": "https://dev.azure.com/integrationstraining/_apis/GraphProfile/MemberAvatars/aad.NDU5ZjM2MjMtM2Q0ZC03MjIxLTgzNjUtZGVhNjgwOTgyZmM2",
                "descriptor": "aad.NDU5ZjM2MjMtM2Q0ZC03MjIxLTgzNjUtZGVhNjgwOTgyZmM2"
            },
            "variables": {},
            "variableGroups": [],
            "preDeployApprovals": {
                "approvals": [{ "rank": 1, "isAutomated": true, "isNotificationOn": false, "id": 4 }],
                "approvalOptions": {
                    "requiredApproverCount": null,
                    "releaseCreatorCanBeApprover": false,
                    "autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped": false,
                    "enforceIdentityRevalidation": false,
                    "timeoutInMinutes": 0,
                    "executionOrder": 1
                }
            },
            "deployStep": { "id": 5 },
            "postDeployApprovals": {
                "approvals": [{ "rank": 1, "isAutomated": true, "isNotificationOn": false, "id": 6 }],
                "approvalOptions": {
                    "requiredApproverCount": null,
                    "releaseCreatorCanBeApprover": false,
                    "autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped": false,
                    "enforceIdentityRevalidation": false,
                    "timeoutInMinutes": 0,
                    "executionOrder": 2
                }
            },
            "deployPhases": [
                {
                    "deploymentInput": {
                        "parallelExecution": { "parallelExecutionType": 0 },
                        "agentSpecification": { "identifier": "ubuntu-20.04" },
                        "skipArtifactsDownload": false,
                        "artifactsDownloadInput": { "downloadInputs": [] },
                        "queueId": 296,
                        "demands": [],
                        "enableAccessToken": false,
                        "timeoutInMinutes": 0,
                        "jobCancelTimeoutInMinutes": 1,
                        "condition": "succeeded()",
                        "overrideInputs": {}
                    },
                    "rank": 1,
                    "phaseType": 1,
                    "name": "Agent job",
                    "refName": null,
                    "workflowTasks": [
                        {
                            "environment": {},
                            "taskId": "31c75bbb-bcdf-4706-8d7c-4da6a1959bc2",
                            "version": "0.*",
                            "name": "Use Node 12.x",
                            "refName": "",
                            "enabled": true,
                            "alwaysRun": false,
                            "continueOnError": false,
                            "timeoutInMinutes": 0,
                            "definitionType": "task",
                            "overrideInputs": {},
                            "condition": "succeeded()",
                            "inputs": { "versionSpec": "12.x", "checkLatest": "false", "force32bit": "false" }
                        },
                        {
                            "environment": {},
                            "taskId": "fe47e961-9fa8-4106-8639-368c022d43ad",
                            "version": "1.*",
                            "name": "npm i -g @pnp/cli-microsoft365",
                            "refName": "",
                            "enabled": true,
                            "alwaysRun": false,
                            "continueOnError": false,
                            "timeoutInMinutes": 0,
                            "definitionType": "task",
                            "overrideInputs": {},
                            "condition": "succeeded()",
                            "inputs": {
                                "command": "custom",
                                "workingDir": "",
                                "verbose": "false",
                                "customCommand": "install -g @pnp/cli-microsoft365",
                                "customRegistry": "useNpmrc",
                                "customFeed": "",
                                "customEndpoint": "",
                                "publishRegistry": "useExternalRegistry",
                                "publishFeed": "",
                                "publishPackageMetadata": "true",
                                "publishEndpoint": ""
                            }
                        },
                        {
                            "environment": {},
                            "taskId": "d9bafed4-0b18-4f58-968d-86655b4d2ce9",
                            "version": "2.*",
                            "name": "Connect to M365",
                            "refName": "",
                            "enabled": true,
                            "alwaysRun": false,
                            "continueOnError": false,
                            "timeoutInMinutes": 0,
                            "definitionType": "task",
                            "overrideInputs": {},
                            "condition": "succeeded()",
                            "inputs": { "script": "m365 login -t password -u $(username) -p $(password)\n", "workingDirectory": "", "failOnStderr": "false" }
                        },
                        {
                            "environment": {},
                            "taskId": "d9bafed4-0b18-4f58-968d-86655b4d2ce9",
                            "version": "2.*",
                            "name": "Upload to App Catalog",
                            "refName": "",
                            "enabled": true,
                            "alwaysRun": false,
                            "continueOnError": false,
                            "timeoutInMinutes": 0,
                            "definitionType": "task",
                            "overrideInputs": {},
                            "condition": "succeeded()",
                            "inputs": {
                                "script": "m365 spo app add -p $(System.DefaultWorkingDirectory)/_spfx/drop/$(pkgname) --overwrite",
                                "workingDirectory": "",
                                "failOnStderr": "false"
                            }
                        },
                        {
                            "environment": {},
                            "taskId": "d9bafed4-0b18-4f58-968d-86655b4d2ce9",
                            "version": "2.*",
                            "name": "Deploy App",
                            "refName": "",
                            "enabled": true,
                            "alwaysRun": false,
                            "continueOnError": false,
                            "timeoutInMinutes": 0,
                            "definitionType": "task",
                            "overrideInputs": {},
                            "condition": "succeeded()",
                            "inputs": { "script": "m365 spo app deploy --name $(pkgname) ", "workingDirectory": "", "failOnStderr": "false" }
                        }
                    ]
                }
            ],
            "environmentOptions": {
                "emailNotificationType": "OnlyOnFailure",
                "emailRecipients": "release.environment.owner;release.creator",
                "skipArtifactsDownload": false,
                "timeoutInMinutes": 0,
                "enableAccessToken": false,
                "publishDeploymentStatus": true,
                "badgeEnabled": false,
                "autoLinkWorkItems": false,
                "pullRequestDeploymentEnabled": false
            },
            "demands": [],
            "conditions": [{ "name": "ReleaseStarted", "conditionType": 1, "value": "" }],
            "executionPolicy": { "concurrencyCount": 1, "queueDepthCount": 0 },
            "schedules": [],
            "currentRelease": {
                "id": 6,
                "url": "https://vsrm.dev.azure.com/integrationstraining/05fd8454-e6fb-4f07-86a0-23dd76609962/_apis/Release/releases/6",
                "_links": {}
            },
            "retentionPolicy": { "daysToKeep": 30, "releasesToKeep": 3, "retainBuild": true },
            "processParameters": {},
            "properties": {
                "BoardsEnvironmentType": { "$type": "System.String", "$value": "unmapped" },
                "LinkBoardsWorkItems": { "$type": "System.String", "$value": "False" }
            },
            "preDeploymentGates": { "id": 0, "gatesOptions": null, "gates": [] },
            "postDeploymentGates": { "id": 0, "gatesOptions": null, "gates": [] },
            "environmentTriggers": [],
            "badgeUrl": "https://vsrm.dev.azure.com/integrationstraining/_apis/public/Release/badge/05fd8454-e6fb-4f07-86a0-23dd76609962/2/2"
        }
    ],
    "artifacts": [
        {
            "sourceId": "05fd8454-e6fb-4f07-86a0-23dd76609962:70",
            "type": "Build",
            "alias": "_spfx",
            "definitionReference": {
                "artifactSourceDefinitionUrl": {
                    "id": "https://dev.azure.com/integrationstraining/_permalink/_build/index?collectionId=22f00c6a-ae63-43eb-94c2-752364698506&projectId=05fd8454-e6fb-4f07-86a0-23dd76609962&definitionId=70",
                    "name": ""
                },
                "defaultVersionBranch": { "id": "", "name": "" },
                "defaultVersionSpecific": { "id": "", "name": "" },
                "defaultVersionTags": { "id": "", "name": "" },
                "defaultVersionType": { "id": "latestType", "name": "Latest" },
                "definition": { "id": "70", "name": "SPFx Build Designer" },
                "definitions": { "id": "", "name": "" },
                "IsMultiDefinitionType": { "id": "False", "name": "False" },
                "project": { "id": "05fd8454-e6fb-4f07-86a0-23dd76609962", "name": "DevOpsWP" },
                "repository": { "id": "", "name": "" }
            },
            "isPrimary": true,
            "isRetained": false
        }
    ],
    "triggers": [{ "artifactAlias": "_spfx", "triggerConditions": [], "triggerType": 1 }],
    "releaseNameFormat": "Release-$(rev:r)",
    "tags": [],
    "properties": {
        "DefinitionCreationSource": { "$type": "System.String", "$value": "ReleaseImport" },
        "IntegrateBoardsWorkItems": { "$type": "System.String", "$value": "False" },
        "IntegrateJiraWorkItems": { "$type": "System.String", "$value": "false" }
    },
    "id": 2,
    "name": "Deploy WP M365 CLI",
    "path": "\\",
    "projectReference": null,
    "url": "https://vsrm.dev.azure.com/integrationstraining/05fd8454-e6fb-4f07-86a0-23dd76609962/_apis/Release/definitions/2",
    "_links": {
        "self": { "href": "https://vsrm.dev.azure.com/integrationstraining/05fd8454-e6fb-4f07-86a0-23dd76609962/_apis/Release/definitions/2" },
        "web": { "href": "https://dev.azure.com/integrationstraining/05fd8454-e6fb-4f07-86a0-23dd76609962/_release?definitionId=2" }
    }
}
